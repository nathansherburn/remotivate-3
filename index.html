<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Remotivate TV</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script></script>
    <style>
      html, body {
        height: 100%;
        width: 100%;
        padding: 0;
        margin: 0;
        overflow: hidden;
        box-sizing: border-box;
        background-color: #fff;
        color: #fff;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 2em;
      }
      
      webview {
        height: 100%;
        width: 100%;
      }

      .load-bar {
        position: fixed;
        top: 0px;
        width: 100%;
        height: 6px;
        background-color: #0F9D58;
      }
      .bar {
        content: "";
        display: inline;
        position: absolute;
        width: 0;
        height: 100%;
        left: 50%;
        text-align: center;
      }
      .bar:nth-child(1) {
        background-color: #db4437;
        animation: loading 3s linear infinite;
      }
      .bar:nth-child(2) {
        background-color: #4285f4;
        animation: loading 3s linear 1s infinite;
      }
      .bar:nth-child(3) {
        background-color: #f4b400;
        animation: loading 3s linear 2s infinite;
      }
      @keyframes loading {
        from {left: 50%; width: 0;z-index:100;}
        33.3333% {left: 0; width: 100%;z-index: 10;}
        to {left: 0; width: 100%;}
      }

      #search-box {
        display: none;
        height: 214px;
        width: 100%;
        position: fixed; top: calc(50% - 107px);
        padding: 20px;
        box-sizing: border-box;
        padding: 0 60px;
      }
      
      #search-box input {
        width: 100%;
        padding: 0;
        margin: 0;
        border: none;
        outline: none;
        font-size: 1em;
        padding: 50px;
        border-radius: 10px;
        box-sizing: border-box;
        color: #333;
        box-shadow: 0px 10px 20px #000;
        background-color: #000;
        color: #fff;
      }
      
      .material-icons {
        font-size: 70px;
      }

    </style>
  </head>
  <body>
    
    <div id="search-box">
      <input id="search-input">
    </div>
    
    <div class="load-bar">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    
    <webview id="content" class="webview" src="blank.html" preload="browser-zoom.js" plugins>
    
  </body>
  <script>
    // You can also require other files to run in this process
    require('./renderer.js')
    const electron = require("electron")    
    const $ = require('jquery')
    const ipc = require('electron').ipcRenderer

    onload = () => {
      const webview = document.getElementById('content')
      const indicator = document.querySelector('.load-bar')
            
      const loadstart = () => {
        indicator.style.display = 'flex'
      }

      const loadstop = () => {
        indicator.style.display = 'none'
      }

      webview.addEventListener('did-start-loading', loadstart)
      webview.addEventListener('did-stop-loading', loadstop)
      webview.addEventListener('console-message', function(m){console.log(m.message)})
      webview.addEventListener('ipc-message', (event) => {
        ipc.send(event.channel)
        console.log('open keyboard')
      })
      
      ipc.on('browser', (event, url) => {
        console.log(webview.src, url)
        if (webview.src !== url) {
          // webview.loadURL( url )
          $('webview').attr('src', url)
        }
      })
      
      ipc.on('nav', (event, action, data) => {
        console.log('nav', action)
        if (action === 'zoomIn') {
          webview.send('zoom', 'in')
        } else if (action === 'zoomOut') {
          webview.send('zoom', 'out')
        } else if (action === 'back') {
          webview.goBack()
        } else if (action === 'forward') {
          webview.goForward()
        } else if (action === 'refresh') {
          webview.reload()
        }
      })


      // $(document).mouseup(function (e) {
      //   var focused = $(':focus')
      //   console.log(focused)
      // })

    }
  </script>
</html>